# codemap - Codebase Map Generator

Scans a project directory and outputs structured markdown with a file tree, module descriptions, entry points, and dependency graph - designed for AI coding agents to instantly understand unfamiliar repos.

## Installation

```bash
# No dependencies required - stdlib only
python codemap.py --help
```

## Usage

```bash
# Map current directory to stdout
python codemap.py .

# Map a specific project, write to file
python codemap.py /path/to/project --output CODEBASE_MAP.md

# Limit depth, skip dep analysis
python codemap.py . --max-depth 3 --no-deps

# Include Mermaid dependency diagram
python codemap.py . --mermaid --output map.md
```

## Examples

```
$ python codemap.py ./myproject --max-depth 3

# Codebase Map: `myproject`

> Generated by codemap.py | Path: `/home/user/myproject`

## Overview

- **Files**: 42
- **Directories**: 8
- **Top file types**: `.py` (28), `.md` (4), `.json` (3), `.yml` (2)

## File Tree

```
myproject/
├── README.md
├── requirements.txt
├── src
│   ├── __init__.py
│   ├── main.py
│   ├── parser.py
│   └── utils.py
└── tests
    ├── test_main.py
    └── test_parser.py
```

## Entry Points

- **`src/main.py`** `[python-main]` - canonical entry-point filename `main.py`
- **`src/cli.py`** `[python-script]` - contains `if __name__ == '__main__'`

## Module Descriptions

### `src`

- **`main.py`** - CLI entry point for the tool
- **`parser.py`** - Parses and validates input files
- **`utils.py`** - Shared utility helpers

## Dependency Graph

### External Dependencies

- `click` (imported in 2 files)
- `pathlib` (imported in 4 files)

### Local Module Dependencies

- **`src/main.py`** imports: `src.parser`, `src.utils`
```

## Options

| Flag | Default | Description |
|------|---------|-------------|
| `directory` | `.` | Project root to scan |
| `--output FILE` | stdout | Write markdown to file |
| `--max-depth N` | `6` | Max directory tree depth |
| `--max-files N` | `300` | Max files to process |
| `--mermaid` | off | Include Mermaid dependency diagram |
| `--no-deps` | off | Skip dependency graph analysis |

## What gets detected

- **File tree**: Visual ASCII tree, auto-skips `node_modules`, `__pycache__`, `.git`, `venv`, `dist`, etc.
- **Module descriptions**: Python docstrings, first comment lines for JS/TS/Go/Rust/etc., `package.json` name+description
- **Entry points**: Named files (`main.py`, `__main__.py`, `index.js`, `Makefile`, `Dockerfile`), Python `if __name__ == '__main__'` guards, `package.json` `bin` fields
- **Dependencies**: Python import analysis (local vs external), JS/TS require/import analysis

## Requirements

- Python 3.10+
- No external dependencies

## License

MIT
